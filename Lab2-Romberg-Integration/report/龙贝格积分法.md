# 实验题目：龙贝格（Romberg）积分法

[toc]

### 问题分析 

实验目的：利用龙贝格积分法计算积分 $\int_a^bf(x)\,dx$

龙贝格求积公式也称为逐次分半加速法。它是在梯形公式、[辛普森公式](https://baike.baidu.com/item/辛普森公式/9255085)和柯特斯公式之间的关系的基础上，构造出一种加速计算积分的方法。 作为一种外推算法，它在不增加计算量的前提下提高了误差的精度。

在等距基点的情况下，用计算机计算积分值通常都采用把[区间](https://baike.baidu.com/item/区间)逐次分半的方法进行。这样，前一次分割得到的函数值在分半以后仍可被利用,且易于编程。

本实验要求给出 $a,b, N, f(x)$ 的情况下输出 Romberg 积分的数表 T

### 数学原理

在数值方法中经常使用一个序列 $f_1,f_2,...$来逼近 $f^{*}$，并且理论上研究其收敛的误差，即余项。在余项估计式的基础上通过外推加速收敛。借助 **Richardson 外推**的思想，由梯形公式的简单组合可以得到比 $h^2$ 更高阶的求积公式如下:
$$
\begin{cases}
T_0(h) = T(h)\\
\\
T_m(h) = \dfrac{4^mT_{m-1}({h\over2})-T_{m-1}(h)}{4^m - 1}
\end{cases}
$$


### 程序设计流程

根据数学原理易得以下交互脚本代码：

```matlab
% Romberg integration algorithm
% Interactive

 f = @(x) x^2*exp(x)
 a = input('Enter lower limit, a:  ');
 b = input('Enter upper limit, b:  ');
 n = input('Enter no. of subintervals, n:  ');
 
 h = b-a;
 r = zeros(2,n+1);
 r(1,1) = (f(a)+f(b))/2*h;
 fprintf('\nRomberg integration table:\n');
 fprintf('\n %11.8f\n\n', r(1,1));

 for i = 2:n
    sum = 0;
    for k = 1:2^(i-2)
       sum = sum+f(a+(k-0.5)*h);
    end
    r(2,1) = (r(1,1)+h*sum)/2;
  
    for j = 2:i
       l = 2^(2*(j-1));
       r(2,j) = r(2,j-1)+(r(2,j-1)-r(1,j-1))/(l-1);
    end

    for k = 1:i
       fprintf(' %11.8f',r(2,k));
    end
 
    fprintf('\n\n');
    h = h/2;
    for j = 1:i
       r(1,j) = r(2,j);
    end
 end
```

#### 

### 实验结果、结论与讨论

***

#### 实验结果

##### 1.1 $\int_0^1x^2e^x\,dx$

```
1.35914091

0.88566062  0.72783385

0.76059633  0.71890824  0.71831320

0.72889018  0.71832146  0.71828234  0.71828185

0.72093578  0.71828431  0.71828184  0.71828183  0.71828183

0.71894543  0.71828198  0.71828183  0.71828183  0.71828183  0.71828183
```

##### 1.2 $\int_1^3 e^xsinx\,dx$

```
 5.12182642

 9.27976291 10.66574174

 10.52055428 10.93415141 10.95204539

 10.84204347 10.94920653 10.95021020 10.95018107

 10.92309389 10.95011070 10.95017097 10.95017035 10.95017031

 10.94339842 10.95016660 10.95017033 10.95017031 10.95017031 10.95017031
```

##### 1.3 $\int_0^1\frac{4}{1+x^2}\,dx$

```
3.00000000

3.10000000 3.13333333

3.13117647 3.14156863  3.14211765

3.13898849 3.14159250  3.14159409  3.14158578

3.14094161 3.14159265  3.14159266  3.14159264  3.14159267

3.14142989 3.14159265  3.14159265  3.14159265  3.14159265  3.14159265

3.14155196 3.14159265  3.14159265  3.14159265  3.14159265  3.14159265 3.14159265
```

##### 1.4 $\int_0^1 \frac{1}{1+x}\,dx$

```
0.75000000

0.70833333  0.69444444

0.69702381  0.69325397  0.69317460

0.69412185  0.69315453  0.69314790  0.69314748

0.69339120  0.69314765  0.69314719  0.69314718  0.69314718
```

#### 思考题

##### 在实验1 中二分次数和精度的关系如何？

答: 二分次数越多，精度就越高，所以一般设定足够的二分次数以达到精度，进行大型运算时要提前确定好精度要求，避免二分次数过多带来不必要的时间开销。

